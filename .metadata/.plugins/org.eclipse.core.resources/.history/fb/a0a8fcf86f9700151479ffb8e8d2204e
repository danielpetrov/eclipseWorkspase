<?php
/* Задача 2:
Използвайки разделянето на масива на части
(партишъни) напишете програма, която да намира k-тия най-
голям елемент в масив.
Пример :
Масив [5, 8, 73, 0, 43, 3424, 78, 98], k = 3
Изход : 78
Масив [5, 8, 73, 0, 43, 3424, 78, 98], k = 1
Изход :  3424 */

$array = [5, 8, 73, 0, 43, 3424, 78, 98];
$k = 3;

//echo partitionWithIndex($array, 0, count($array) - 1, 6);
echo kMaxElementOfArray(count($array) - $k, 0, count($array) - 1, $array);
//echo phpinfo();
function kMaxElementOfArray($needle, $startIndex, $endIndex, $array){
	//$randomPivot = rand($startIndex, $endIndex);
	
	$pivot = partition($array, $startIndex, $endIndex);
	
	if($needle - 1 < $pivot){
		return kMaxElementOfArray($needle, $startIndex, $pivot - 1, $array);
	} else if($needle - 1 > $pivot){
		return kMaxElementOfArray($needle, $pivot + 1, $endIndex, $array);
	} else return $array[$pivot];
	
}

function partition(&$array, $low, $high){
	$pivot = $array[$high];
	$i = $low;
	for ($j = $low; $j < $high; $j++) {
		if ($array[$j] <= $pivot) {
			swap($array, $i, $j);
			$i++;
		}
	}
	
	swap($array, $i, $high);
	
	return $i;
}

function swap(&$array, $index1, $index2) {
	$swapy = $array [$index1];
	$array [$index1] = $array [$index2];
	$array [$index2] = $swapy;
}